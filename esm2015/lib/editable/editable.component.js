import { ChangeDetectionStrategy, Component, ContentChild, ElementRef, EventEmitter, Inject, Input, Output, } from '@angular/core';
import { BehaviorSubject, fromEvent, Subject } from 'rxjs';
import { filter, skip, switchMap, take, takeUntil, withLatestFrom } from 'rxjs/operators';
import { ViewModeDirective } from '../directives/view-mode.directive';
import { EditModeDirective } from '../directives/edit-mode.directive';
import { EDITABLE_CONFIG } from './editable.config';
export class EditableComponent {
    constructor(el, config) {
        this.el = el;
        this.config = config;
        this.openOn = this.config.openOn;
        this.closeOn = this.config.closeOn;
        this.save = new EventEmitter();
        this.cancel = new EventEmitter();
        this.onStateChange = new EventEmitter();
        this.editMode = new BehaviorSubject(false);
        this.editMode$ = this.editMode.asObservable();
        this.destroy$ = new Subject();
        this.isGrouped = false;
    }
    get element() {
        return this.el.nativeElement;
    }
    ngOnInit() {
        this.handleViewMode();
        this.handleEditMode();
    }
    ngOnDestroy() {
        this.destroy$.next(true);
    }
    handleViewMode() {
        this.viewHandler = fromEvent(this.element, this.openOn)
            .pipe(withLatestFrom(this.editMode$), filter(([_, editMode]) => !editMode), takeUntil(this.destroy$))
            .subscribe(() => this.displayEditMode());
    }
    handleEditMode() {
        const clickOutside$ = (editMode) => fromEvent(document, this.closeOn).pipe(filter(() => editMode), 
        /*
        skip the first propagated event if there is a nested node in the viewMode templateRef
        so it doesn't trigger this eventListener when switching to editMode
         */
        skip(this.openOn === this.closeOn ? 1 : 0), filter(({ target }) => this.element.contains(target) === false), take(1));
        this.editHandler = this.editMode$
            .pipe(switchMap((editMode) => clickOutside$(editMode)), takeUntil(this.destroy$))
            .subscribe(() => this.saveEdit());
    }
    displayEditMode() {
        this.editMode.next(true);
        this.onStateChange.emit('edit');
    }
    saveEdit() {
        this.save.next();
        this.leaveEditMode();
    }
    cancelEdit() {
        this.cancel.next();
        this.leaveEditMode();
    }
    leaveEditMode() {
        this.editMode.next(false);
        this.onStateChange.emit('view');
        if (!this.isGrouped) {
            this.viewHandler.unsubscribe();
            setTimeout(() => this.handleViewMode(), 0);
        }
    }
}
EditableComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-inline-edit',
                template: `
    <ng-container *ngTemplateOutlet="(editMode$ | async) ? editModeTpl.tpl : viewModeTpl.tpl"></ng-container>
  `,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [':host {cursor: pointer;}']
            },] }
];
EditableComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: undefined, decorators: [{ type: Inject, args: [EDITABLE_CONFIG,] }] }
];
EditableComponent.propDecorators = {
    openOn: [{ type: Input }],
    closeOn: [{ type: Input }],
    save: [{ type: Output }],
    cancel: [{ type: Output }],
    onStateChange: [{ type: Output }],
    viewModeTpl: [{ type: ContentChild, args: [ViewModeDirective,] }],
    editModeTpl: [{ type: ContentChild, args: [EditModeDirective,] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWluLXBsYWNlLWVkaXQvc3JjL2xpYi9lZGl0YWJsZS9lZGl0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsWUFBWSxFQUNaLFVBQVUsRUFDVixZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFHTCxNQUFNLEdBQ1AsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGVBQWUsRUFBRSxTQUFTLEVBQWMsT0FBTyxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUNyRixPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxjQUFjLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMxRixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN0RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN0RSxPQUFPLEVBQUUsZUFBZSxFQUFrQixNQUFNLG1CQUFtQixDQUFDO0FBV3BFLE1BQU0sT0FBTyxpQkFBaUI7SUFrQjVCLFlBQTZCLEVBQWMsRUFBb0MsTUFBc0I7UUFBeEUsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUFvQyxXQUFNLEdBQU4sTUFBTSxDQUFnQjtRQWpCNUYsV0FBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQzVCLFlBQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUU3QixTQUFJLEdBQXVCLElBQUksWUFBWSxFQUFRLENBQUM7UUFDcEQsV0FBTSxHQUF1QixJQUFJLFlBQVksRUFBUSxDQUFDO1FBQ3RELGtCQUFhLEdBQXVCLElBQUksWUFBWSxFQUFRLENBQUM7UUFLdEQsYUFB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LENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQy9CLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDNUM7SUFDSCxDQUFDOzs7WUE5RkYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxpQkFBaUI7Z0JBQzNCLFFBQVEsRUFBRTs7R0FFVDtnQkFFRCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTt5QkFEdEMsMEJBQTBCO2FBRXBDOzs7WUF0QkMsVUFBVTs0Q0F5Q29DLE1BQU0sU0FBQyxlQUFlOzs7cUJBakJuRSxLQUFLO3NCQUNMLEtBQUs7bUJBRUwsTUFBTTtxQkFDTixNQUFNOzRCQUNOLE1BQU07MEJBRU4sWUFBWSxTQUFDLGlCQUFpQjswQkFDOUIsWUFBWSxTQUFDLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ29tcG9uZW50LFxyXG4gIENvbnRlbnRDaGlsZCxcclxuICBFbGVtZW50UmVmLFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbmplY3QsXHJcbiAgSW5wdXQsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uSW5pdCxcclxuICBPdXRwdXQsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgZnJvbUV2ZW50LCBPYnNlcnZhYmxlLCBTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZmlsdGVyLCBza2lwLCBzd2l0Y2hNYXAsIHRha2UsIHRha2VVbnRpbCwgd2l0aExhdGVzdEZyb20gfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFZpZXdNb2RlRGlyZWN0aXZlIH0gZnJvbSAnLi4vZGlyZWN0aXZlcy92aWV3LW1vZGUuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRWRpdE1vZGVEaXJlY3RpdmUgfSBmcm9tICcuLi9kaXJlY3RpdmVzL2VkaXQtbW9kZS5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBFRElUQUJMRV9DT05GSUcsIEVkaXRhYmxlQ29uZmlnIH0gZnJvbSAnLi9lZGl0YWJsZS5jb25maWcnO1xyXG5pbXBvcnQgeyBNb2RlIH0gZnJvbSAnLi9tb2RlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmd4LWlubGluZS1lZGl0JyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIihlZGl0TW9kZSQgfCBhc3luYykgPyBlZGl0TW9kZVRwbC50cGwgOiB2aWV3TW9kZVRwbC50cGxcIj48L25nLWNvbnRhaW5lcj5cclxuICBgLFxyXG4gIHN0eWxlczogWyc6aG9zdCB7Y3Vyc29yOiBwb2ludGVyO30nXSxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxufSlcclxuZXhwb3J0IGNsYXNzIEVkaXRhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gIEBJbnB1dCgpIG9wZW5PbiA9IHRoaXMuY29uZmlnLm9wZW5PbjtcclxuICBASW5wdXQoKSBjbG9zZU9uID0gdGhpcy5jb25maWcuY2xvc2VPbjtcclxuXHJcbiAgQE91dHB1dCgpIHNhdmU6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuICBAT3V0cHV0KCkgY2FuY2VsOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcbiAgQE91dHB1dCgpIG9uU3RhdGVDaGFuZ2U6IEV2ZW50RW1pdHRlcjxNb2RlPiA9IG5ldyBFdmVudEVtaXR0ZXI8TW9kZT4oKTtcclxuXHJcbiAgQENvbnRlbnRDaGlsZChWaWV3TW9kZURpcmVjdGl2ZSkgdmlld01vZGVUcGw6IFZpZXdNb2RlRGlyZWN0aXZlO1xyXG4gIEBDb250ZW50Q2hpbGQoRWRpdE1vZGVEaXJlY3RpdmUpIGVkaXRNb2RlVHBsOiBFZGl0TW9kZURpcmVjdGl2ZTtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBlZGl0TW9kZTogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPihmYWxzZSk7XHJcbiAgcHVibGljIHJlYWRvbmx5IGVkaXRNb2RlJDogT2JzZXJ2YWJsZTxib29sZWFuPiA9IHRoaXMuZWRpdE1vZGUuYXNPYnNlcnZhYmxlKCk7XHJcbiAgcHVibGljIHZpZXdIYW5kbGVyOiBTdWJzY3JpcHRpb247XHJcbiAgcHVibGljIGVkaXRIYW5kbGVyOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBkZXN0cm95JDogU3ViamVjdDxib29sZWFuPiA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XHJcbiAgcHVibGljIGlzR3JvdXBlZCA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGVsOiBFbGVtZW50UmVmLCBASW5qZWN0KEVESVRBQkxFX0NPTkZJRykgcmVhZG9ubHkgY29uZmlnOiBFZGl0YWJsZUNvbmZpZykge31cclxuXHJcbiAgcHJpdmF0ZSBnZXQgZWxlbWVudCgpOiBhbnkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5oYW5kbGVWaWV3TW9kZSgpO1xyXG4gICAgdGhpcy5oYW5kbGVFZGl0TW9kZSgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhbmRsZVZpZXdNb2RlKCk6IHZvaWQge1xyXG4gICAgdGhpcy52aWV3SGFuZGxlciA9IGZyb21FdmVudCh0aGlzLmVsZW1lbnQsIHRoaXMub3Blbk9uKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICB3aXRoTGF0ZXN0RnJvbSh0aGlzLmVkaXRNb2RlJCksXHJcbiAgICAgICAgZmlsdGVyKChbXywgZWRpdE1vZGVdKSA9PiAhZWRpdE1vZGUpLFxyXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICApXHJcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5kaXNwbGF5RWRpdE1vZGUoKSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhbmRsZUVkaXRNb2RlKCk6IHZvaWQge1xyXG4gICAgY29uc3QgY2xpY2tPdXRzaWRlJCA9IChlZGl0TW9kZTogYm9vbGVhbikgPT5cclxuICAgICAgZnJvbUV2ZW50KGRvY3VtZW50LCB0aGlzLmNsb3NlT24pLnBpcGUoXHJcbiAgICAgICAgZmlsdGVyKCgpID0+IGVkaXRNb2RlKSxcclxuICAgICAgICAvKlxyXG4gICAgICAgIHNraXAgdGhlIGZpcnN0IHByb3BhZ2F0ZWQgZXZlbnQgaWYgdGhlcmUgaXMgYSBuZXN0ZWQgbm9kZSBpbiB0aGUgdmlld01vZGUgdGVtcGxhdGVSZWZcclxuICAgICAgICBzbyBpdCBkb2Vzbid0IHRyaWdnZXIgdGhpcyBldmVudExpc3RlbmVyIHdoZW4gc3dpdGNoaW5nIHRvIGVkaXRNb2RlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2tpcCh0aGlzLm9wZW5PbiA9PT0gdGhpcy5jbG9zZU9uID8gMSA6IDApLFxyXG4gICAgICAgIGZpbHRlcigoeyB0YXJnZXQgfSkgPT4gdGhpcy5lbGVtZW50LmNvbnRhaW5zKHRhcmdldCkgPT09IGZhbHNlKSxcclxuICAgICAgICB0YWtlKDEpXHJcbiAgICAgICk7XHJcblxyXG4gICAgdGhpcy5lZGl0SGFuZGxlciA9IHRoaXMuZWRpdE1vZGUkXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIHN3aXRjaE1hcCgoZWRpdE1vZGU6IGJvb2xlYW4pID0+IGNsaWNrT3V0c2lkZSQoZWRpdE1vZGUpKSxcclxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgKVxyXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuc2F2ZUVkaXQoKSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZGlzcGxheUVkaXRNb2RlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5lZGl0TW9kZS5uZXh0KHRydWUpO1xyXG4gICAgdGhpcy5vblN0YXRlQ2hhbmdlLmVtaXQoJ2VkaXQnKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzYXZlRWRpdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuc2F2ZS5uZXh0KCk7XHJcbiAgICB0aGlzLmxlYXZlRWRpdE1vZGUoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjYW5jZWxFZGl0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5jYW5jZWwubmV4dCgpO1xyXG4gICAgdGhpcy5sZWF2ZUVkaXRNb2RlKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGxlYXZlRWRpdE1vZGUoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVkaXRNb2RlLm5leHQoZmFsc2UpO1xyXG4gICAgdGhpcy5vblN0YXRlQ2hhbmdlLmVtaXQoJ3ZpZXcnKTtcclxuICAgIGlmICghdGhpcy5pc0dyb3VwZWQpIHtcclxuICAgICAgdGhpcy52aWV3SGFuZGxlci51bnN1YnNjcmliZSgpO1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaGFuZGxlVmlld01vZGUoKSwgMCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==